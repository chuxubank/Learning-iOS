<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Swift Overview | Learning iOS</title>
    <meta name="description" content="Notes in learning iOS">
    
    
    <link rel="preload" href="/Learning-iOS/assets/css/0.styles.41431748.css" as="style"><link rel="preload" href="/Learning-iOS/assets/js/app.57d53fc2.js" as="script"><link rel="preload" href="/Learning-iOS/assets/js/2.92025711.js" as="script"><link rel="preload" href="/Learning-iOS/assets/js/8.63388885.js" as="script"><link rel="prefetch" href="/Learning-iOS/assets/js/10.5cadec28.js"><link rel="prefetch" href="/Learning-iOS/assets/js/11.e17e5268.js"><link rel="prefetch" href="/Learning-iOS/assets/js/12.dc0478b7.js"><link rel="prefetch" href="/Learning-iOS/assets/js/13.a28b7d7b.js"><link rel="prefetch" href="/Learning-iOS/assets/js/3.1e3883d7.js"><link rel="prefetch" href="/Learning-iOS/assets/js/4.54001d48.js"><link rel="prefetch" href="/Learning-iOS/assets/js/5.483e08f1.js"><link rel="prefetch" href="/Learning-iOS/assets/js/6.e51ab43a.js"><link rel="prefetch" href="/Learning-iOS/assets/js/7.00095480.js"><link rel="prefetch" href="/Learning-iOS/assets/js/9.9306c96a.js">
    <link rel="stylesheet" href="/Learning-iOS/assets/css/0.styles.41431748.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Learning-iOS/" class="home-link router-link-active"><!----> <span class="site-name">Learning iOS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Learning-iOS/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Stanford</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>CS193P iPhone Application Development</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/" class="nav-link router-link-active">Developing iOS 11 Apps with Swift</a></li></ul></li></ul></div></div> <a href="https://github.com/chuxubank/Learning-iOS" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Learning-iOS/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Stanford</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>CS193P iPhone Application Development</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/" class="nav-link router-link-active">Developing iOS 11 Apps with Swift</a></li></ul></li></ul></div></div> <a href="https://github.com/chuxubank/Learning-iOS" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L1-Introduction-to-iOS11-Xcode9-Swift4/" class="sidebar-link">Introduction to iOS 11, Xcode 9 and Swift 4</a></li><li><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L2-MVC-iOS-Xcode-Swift-Demonstration/" class="sidebar-link">MVC; iOS, Xcode and Swift Demonstration</a></li><li><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/" class="active sidebar-link">Swift Overview</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#swift-programming-language" class="sidebar-link">Swift Programming Language</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#✅-watch-the-third-lecture-video" class="sidebar-link">✅ Watch the third lecture video.</a></li><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#✅-review-lecture-3-slides" class="sidebar-link">✅ Review Lecture 3 Slides.</a></li><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#✅-complete-the-second-reading" class="sidebar-link">✅ Complete the second reading.</a></li></ul></li><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#more-swift" class="sidebar-link">More Swift</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#✅-watch-the-fourth-lecture-video" class="sidebar-link">✅ Watch the fourth lecture video.</a></li><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#✅-review-lecture-4-slides" class="sidebar-link">✅ Review Lecture 4 Slides.</a></li><li class="sidebar-sub-header"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/#✅-complete-programming-project-2" class="sidebar-link">✅ Complete Programming Project 2.</a></li></ul></li></ul></li><li><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L4-Drawing-in-iOS/" class="sidebar-link">Drawing in iOS</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="swift-overview"><a href="#swift-overview" aria-hidden="true" class="header-anchor">#</a> Swift Overview</h1> <p></p><div class="table-of-contents"><ul><li><a href="#swift-programming-language">Swift Programming Language</a><ul><li><a href="#✅-watch-the-third-lecture-video">✅ Watch the third lecture video.</a></li><li><a href="#✅-review-lecture-3-slides">✅ Review Lecture 3 Slides.</a><ul><li><a href="#autolayout-teaser">Autolayout teaser</a></li><li><a href="#quick-review-of-what-we-learned-in-concentration">Quick review of what we learned in Concentration</a></li><li><a href="#countablerange-of-floating-point-numbers">CountableRange of floating point numbers</a></li><li><a href="#tuples">Tuples</a></li><li><a href="#computed-properties">Computed Properties</a></li><li><a href="#access-control">Access Control</a></li><li><a href="#assertions">assertions</a></li><li><a href="#extensions">extensions</a></li><li><a href="#enum">enum</a></li><li><a href="#optionals-are-enums">Optionals are enums</a></li><li><a href="#data-structure-review-including-memory-management">Data structure review (including memory management)</a></li><li><a href="#memory-management">Memory Management</a></li><li><a href="#protocols-time-permitting">protocols (time permitting)</a></li></ul></li><li><a href="#✅-complete-the-second-reading">✅ Complete the second reading.</a></li></ul></li><li><a href="#more-swift">More Swift</a><ul><li><a href="#✅-watch-the-fourth-lecture-video">✅ Watch the fourth lecture video.</a></li><li><a href="#✅-review-lecture-4-slides">✅ Review Lecture 4 Slides.</a><ul><li><a href="#quick-demo-of-mutating">Quick demo of mutating</a></li><li><a href="#protocols">protocols</a></li><li><a href="#delegation">Delegation</a></li><li><a href="#another-use-of-protocols">Another use of Protocols</a></li><li><a href="#advanced-use-of-protocols">Advanced use of Protocols</a></li><li><a href="#string">String</a></li><li><a href="#nsattributedstring">NSAttributedString</a></li><li><a href="#closures-and-functions-as-types-in-general">Closures (and functions as types in general)</a></li></ul></li><li><a href="#✅-complete-programming-project-2">✅ Complete Programming Project 2.</a></li></ul></li></ul></div><p></p> <h2 id="swift-programming-language"><a href="#swift-programming-language" aria-hidden="true" class="header-anchor">#</a> Swift Programming Language</h2> <p>Paul Hegarty begins with a demonstration of making Concentration's button layout dynamic. He then reviews the first two lectures and continues diving into Swift.</p> <p>Topics Include: Swift, Autolayout, CountableRange, Tuples, Computer Properties, Access Control, Assertions, Extensions, enum, Optionals, Data Structure, Protocols</p> <p>Note: English subtitles are available within the video: enable English CC subtitles.</p> <h3 id="✅-watch-the-third-lecture-video"><a href="#✅-watch-the-third-lecture-video" aria-hidden="true" class="header-anchor">#</a> ✅ Watch the third lecture video.</h3> <p><a href="https://youtu.be/ZbpjTPzf8x4?list=PLPA-ayBrweUzGFmkT_W65z64MoGnKRZMq" target="_blank" rel="noopener noreferrer">Lecture 3: Swift Programming Language<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <video width="100%" controls="controls" preload=""><source src="https://applehosted.podcasts.apple.com/stanford/media/3_Swift_Programming_Language_319-2557083044702627203-03_10_02_17_prores_CS193p_1080p_3mb_cc.m4v"></video> <h3 id="✅-review-lecture-3-slides"><a href="#✅-review-lecture-3-slides" aria-hidden="true" class="header-anchor">#</a> ✅ Review Lecture 3 Slides.</h3> <p><a href="https://github.com/chuxubank/Learning-iOS/blob/master/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/Lecture-3-Slides.pdf" target="_blank" rel="noopener noreferrer">Lecture 3 Slides<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="autolayout-teaser"><a href="#autolayout-teaser" aria-hidden="true" class="header-anchor">#</a> Autolayout teaser</h4> <p>Making Concentration’s button layout dynamic:</p> <p>We want our UI to work on different iPhones and in both landscape and portrait We’ll do this using UIStackView and autolayout
This is only a taste of what’s to come on this front in a couple of weeks</p> <h4 id="quick-review-of-what-we-learned-in-concentration"><a href="#quick-review-of-what-we-learned-in-concentration" aria-hidden="true" class="header-anchor">#</a> Quick review of what we learned in Concentration</h4> <p>Brief Review of Week 1:</p> <ul><li>Target/Action and Outlets and Outlet Collections</li> <li>Methods and Properties (aka instance variables)</li> <li>Property Observer (<code>didSet</code>)</li> <li><code>Array&lt;Element&gt;</code></li> <li>MVC</li> <li>Value types (<code>struct</code>) versus reference types (<code>class</code>)</li> <li><code>init</code>ializers</li> <li>Type (<code>static</code>) methods</li> <li><code>lazy</code> properties</li> <li><code>for in</code> loops</li> <li><code>Dictionary&lt;Key,Value&gt;</code></li> <li>Type conversion (e.g. <code>UInt32(anInt)</code>)</li> <li>And, of course, Optionals, which we’re going to revisit in more detail a bit later in this lecture</li></ul> <h4 id="countablerange-of-floating-point-numbers"><a href="#countablerange-of-floating-point-numbers" aria-hidden="true" class="header-anchor">#</a> <code>CountableRange</code> of floating point numbers</h4> <p>Floating point CountableRange:</p> <p>How do you do <code>for (i = 0.5; i &lt;= 15.25; i += 0.3)</code>?</p> <p>Floating point numbers don’t stride by Int, they stride by a floating point value.</p> <p>So <code>0.5...15.25</code> is just a Range, not a CountableRange (which is needed for <code>for in</code>).</p> <p>Luckily, there’s a global function that will create a CountableRange from floating point values!</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token function">stride</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> through<span class="token punctuation">:</span> <span class="token number">15.25</span><span class="token punctuation">,</span> by<span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>The return type of stride is <code>CountableRange</code> (actually <code>ClosedCountableRange</code> in this case because it’s <code>through:</code> instead of <code>to:</code>).</p> <p>As we’ll see with String later, CountableRange is a generic type (doesn’t have to be Ints).</p> <h4 id="tuples"><a href="#tuples" aria-hidden="true" class="header-anchor">#</a> Tuples</h4> <p><strong>What is a tuple?</strong></p> <p>It is nothing more than a grouping of values. You can use it anywhere you can use a type.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>“hello”<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">)</span> <span class="token comment">// the type of x is “a tuple”</span>
<span class="token keyword">let</span> <span class="token punctuation">(</span>word<span class="token punctuation">,</span> number<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">=</span> x <span class="token comment">// this names the tuple elements when accessing the tuple print(word) // prints hello</span>
<span class="token function">print</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token comment">// prints 5</span>
<span class="token function">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment">// prints 0.85</span>
</code></pre></div><p>... or the tuple elements can be named when the tuple is <code>declared</code> (this is strongly preferred) ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>w<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> i<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> v<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>“hello”<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>w<span class="token punctuation">)</span> <span class="token comment">// prints hello</span>
<span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>i<span class="token punctuation">)</span> <span class="token comment">// prints 5</span>
<span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>v<span class="token punctuation">)</span> <span class="token comment">// prints 0.85</span>
<span class="token keyword">let</span> <span class="token punctuation">(</span>wrd<span class="token punctuation">,</span> num<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">=</span> x <span class="token comment">// this is also legal (renames the tuple’s elements on access)</span>
</code></pre></div><p><strong>Tuples as return values</strong></p> <p>You can use tuples to return multiple values from a function or method ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>weight<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>“weight <span class="token keyword">is</span> \<span class="token punctuation">(</span>x<span class="token punctuation">.</span>weight<span class="token punctuation">)</span>”<span class="token punctuation">)</span> <span class="token comment">// weight is 250</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> or <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function">print</span><span class="token punctuation">(</span>“height <span class="token keyword">is</span> \<span class="token punctuation">(</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span>”<span class="token punctuation">)</span> <span class="token comment">// height is 80</span>
</code></pre></div><h4 id="computed-properties"><a href="#computed-properties" aria-hidden="true" class="header-anchor">#</a> Computed Properties</h4> <p><strong>The value of a property can be computed rather than stored</strong></p> <p>A typical stored property looks something like this ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> foo<span class="token punctuation">:</span> <span class="token builtin">Double</span>
</code></pre></div><p>A computed property looks like this ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> foo<span class="token punctuation">:</span> <span class="token builtin">Double</span> <span class="token punctuation">{</span>
	<span class="token keyword">get</span> <span class="token punctuation">{</span>
	<span class="token comment">// return the calculated value of foo</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// do something based on the fact that foo has changed to newValue</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You don’t have to implement the set side of it if you don’t want to. The property then becomes “read only”.</p> <div class="tip custom-block"><p>If you have a read only property, you do not actually have to have the word <code>get</code> there.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> numberOfPairsOfCards<span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>cardButtons<span class="token punctuation">.</span><span class="token builtin">count</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p><strong>Why compute the value of a property?</strong></p> <p>Lots of times a “property” is “derived” from other state.</p> <p>For example, in Concentration, we can derive this var easily from looking at the cards ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> indexOfOneAndOnlyFaceUpCard<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token operator">?</span>
</code></pre></div><p>In fact, properly keeping this var up-to-date is just plain error-prone. This would be safer ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> indexOfOneAndOnlyFaceUpCard<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token operator">?</span> <span class="token punctuation">{</span>
	<span class="token keyword">get</span> <span class="token punctuation">{</span>
	<span class="token comment">// look at all the cards and see if you find only one that’s face up</span>
	<span class="token comment">// if so, return it, else return nil</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">set</span> <span class="token punctuation">{</span>
	<span class="token comment">// turn all the cards face down except the card at index newValue</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Let’s go to Concentration and make this change ...</p> <p><strong>Make <code>indexOfOneAndOnlyFaceUpCard</code> be computed</strong></p> <p>That way it will always be in sync</p> <p>And we’ll see that the rest of our code gets even simpler because of it</p> <h4 id="access-control"><a href="#access-control" aria-hidden="true" class="header-anchor">#</a> Access Control</h4> <p><strong>Protecting our internal implementations</strong></p> <p>Likely most of you have only worked on relatively small projects</p> <p>Inside those projects, any object can pretty much call any function in any other object When projects start to get large, though, this becomes very dicey</p> <p>You want to be able to protect the INTERNAL implementation of data structures</p> <p>You do this by marking which API<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> you want other code to use with certain keywords</p> <p>Swift supports this with the following access control keywords ...</p> <ul><li><code>internal</code> - this is the default, it means “usable by any object in my app or framework”</li> <li><code>private</code> - this means “only callable from within this object”</li> <li><code>private(set)</code> - this means “this property is readable outside this object, but not settable”</li> <li><code>fileprivate</code> - accessible by any code in this source file</li> <li><code>public</code> - (for frameworks only) this can be used by objects outside my framework</li> <li><code>open</code> - (for frameworks only) public and objects outside my framework can subclass this</li></ul> <p>We are not going to learn to develop frameworks this quarter, so we are only concerned with ... private, private(set), fileprivate and internal (which is the default, so no keyword)</p> <p>A good strategy is to just mark everything private by default.  Then remove the private designation when that API is ready to be used by other code.</p> <p>Concentration needs some access control ...</p> <p><strong>Add access control to Concentration</strong></p> <p>Even though our app is small, we want to learn to develop like we’re on a big team Also, let’s protect our API with assertions too</p> <h4 id="assertions"><a href="#assertions" aria-hidden="true" class="header-anchor">#</a> <code>assertions</code></h4> <p>An <code>assertion</code> is just a function that you call where you assert something to be true.  And if it's not your program crashes and print out an error.</p> <p>And you put it in your code, the asserts are ignored when you ship to the App Store. But when you're in development, it'll be crashing your program, which is good, cuz it takes the debugger right to the assertion failed.</p> <p>And asserts are a great way to protect your API.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function">chooseCard</span><span class="token punctuation">(</span>at index<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">assert</span><span class="token punctuation">(</span>cards<span class="token punctuation">.</span><span class="token builtin">indices</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Concentration.chooseCard(at: <span class="token interpolation"><span class="token delimiter variable">\(</span>index<span class="token delimiter variable">)</span></span>) : Choosen index out of range&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="extensions"><a href="#extensions" aria-hidden="true" class="header-anchor">#</a> <code>extensions</code></h4> <ul><li><p>Extending existing data structures</p> <p>You can add methods/properties to a class/struct/enum (even if you don’t have the source).</p></li> <li><p>There are some restrictions</p> <p>You can’t re-implement methods or properties that are already there (only add new ones). The properties you add can have <strong>no storage</strong> associated with them (computed only).</p></li> <li><p>This feature is easily abused</p> <p>It should be used to add clarity to readability not obfuscation!</p> <p>Don’t use it as a substitute for good object-oriented design technique.</p> <p>Best used (at least for beginners) for very small, well-contained helper functions. Can actually be used well to organize code but requires architectural commitment. When in doubt (for now), don’t do it.</p></li></ul> <p>Let’s add a simple <code>extension</code> in Concentration ...</p> <p>Make <code>arc4random</code> code a lot cleaner</p> <p>In your homework you are using it at least twice</p> <p>And it’s easy to imagine using it even more often in Concentration and beyond</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> arc4Random<span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> <span class="token keyword">self</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token builtin">Int</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token function">Int</span><span class="token punctuation">(</span><span class="token function">arc4random_uniform</span><span class="token punctuation">(</span><span class="token function">UInt32</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">-</span><span class="token builtin">Int</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token function">Int</span><span class="token punctuation">(</span><span class="token function">arc4random_uniform</span><span class="token punctuation">(</span><span class="token function">UInt32</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token number">0</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="enum"><a href="#enum" aria-hidden="true" class="header-anchor">#</a> <code>enum</code></h4> <p><strong>Another variety of data structure in addition to <code>struct</code> and <code>class</code></strong></p> <p>It can only have discrete states ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> hamburger
	<span class="token keyword">case</span> fries
	<span class="token keyword">case</span> drink
	<span class="token keyword">case</span> cookie
<span class="token punctuation">}</span>
</code></pre></div><p>An enum is a VALUE TYPE (like struct), so it is copied as it is passed around</p> <p><strong>Associated Data</strong></p> <p>Each state can (but does not have to) have its own “associated data” ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token function">hamburger</span><span class="token punctuation">(</span>numberOfPatties<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token function">fries</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token builtin">FryOrderSize</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token function">drink</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> ounces<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token comment">// the unnamed String is the brand, e.g. “Coke”</span>
	<span class="token keyword">case</span> cookie
<span class="token punctuation">}</span>
</code></pre></div><p>Note that the drink case has 2 pieces of associated data (one of them “unnamed”) In the example above, FryOrderSize would also probably be an enum, for example ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">FryOrderSize</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> large
	<span class="token keyword">case</span> small
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Setting the value of an <code>enum</code></strong></p> <p>Assigning a value to a variable or constant of type enum is easy ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> menuItem<span class="token punctuation">:</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token operator">=</span>
<span class="token keyword">var</span> otherItem<span class="token punctuation">:</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token operator">=</span>
</code></pre></div><p>Just use the name of the type along with the case you want, separated by dot ...</p> <p>When you set the value of an enum you must provide the associated data (if any) ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> menuItem<span class="token punctuation">:</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span>patties<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> otherItem<span class="token punctuation">:</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span>cookie
</code></pre></div><p>Swift can infer the type on one side of the assignment or the other (but not both) ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> menuItem <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span>patties<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> otherItem<span class="token punctuation">:</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token operator">=</span> <span class="token punctuation">.</span>cookie
<span class="token keyword">var</span> yetAnotherItem <span class="token operator">=</span> <span class="token punctuation">.</span>cookie <span class="token comment">// Swift can’t figure this out</span>
</code></pre></div><p><strong>Checking an enum’s state</strong></p> <p>An enum’s state is checked with a switch statement ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code>  <span class="token keyword">var</span> menuItem <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span>patties<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token keyword">switch</span> menuItem <span class="token punctuation">{</span>
	  <span class="token keyword">case</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span>hamburger<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“burger”<span class="token punctuation">)</span>
	  <span class="token keyword">case</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span>fries<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“fries”<span class="token punctuation">)</span>
	  <span class="token keyword">case</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span>drink<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“drink”<span class="token punctuation">)</span>
	  <span class="token keyword">case</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span>cookie<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“cookie”<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note that we are ignoring the “associated data” above ... so far ...</p> <p>This code would print “burger” on the console</p> <p><strong><code>break</code></strong></p> <p>If you don’t want to do anything in a given case, use <code>break</code> ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> menuItem <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span>patties<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">switch</span> menuItem <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>hamburger<span class="token punctuation">:</span> <span class="token keyword">break</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>fries<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“fries”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>drink<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“drink”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>cookie<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“cookie”<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This code would print nothing on the console</p> <p><strong><code>default</code></strong></p> <p>You must handle ALL POSSIBLE CASES (although you can default uninteresting cases) ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> menuItem <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span>cookie
<span class="token keyword">switch</span> menuItem <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>hamburger<span class="token punctuation">:</span> <span class="token keyword">break</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>fries<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“fries”<span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“other”<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If the menuItem were a cookie, the above code would print “other” on the console</p> <div class="tip custom-block"><p>You can switch any type in Swift, even switch on a <code>string</code>, of cause you are going to use <code>default</code> in a <code>string</code> case.</p></div> <p><strong>Multiple lines allowed</strong></p> <p>Each case in a switch can be multiple lines and does NOT fall through to the next case ... (Very different from C/C++)</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> menuItem <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">fries</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token builtin">FryOrderSize</span><span class="token punctuation">.</span>large<span class="token punctuation">)</span>
<span class="token keyword">switch</span> menuItem <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>hamburger<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“burger”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>fries<span class="token punctuation">:</span>
	<span class="token function">print</span><span class="token punctuation">(</span>“yummy”<span class="token punctuation">)</span>
	<span class="token function">print</span><span class="token punctuation">(</span>“fries”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>drink<span class="token punctuation">:</span>
	<span class="token function">print</span><span class="token punctuation">(</span>“drink”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>cookie<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“cookie”<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above code would print “yummy” and “fries” on the console, but not “drink”</p> <p>By the way, we can let Swift infer the enum type of the size of the fries too ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> menuItem <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">fries</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token punctuation">.</span>large<span class="token punctuation">)</span>
</code></pre></div><p><strong>What about the associated data?</strong></p> <p>Associated data is accessed through a switch statement using this <code>let</code> syntax ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> menuItem <span class="token operator">=</span> <span class="token builtin">FastFoodMenuItem</span><span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span>“<span class="token builtin">Coke</span>”<span class="token punctuation">,</span> ounces<span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">)</span>
<span class="token keyword">switch</span> menuItem <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span><span class="token keyword">let</span> pattyCount<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“a burger with \<span class="token punctuation">(</span>pattyCount<span class="token punctuation">)</span> patties<span class="token operator">!</span>”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">fries</span><span class="token punctuation">(</span><span class="token keyword">let</span> size<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“a \<span class="token punctuation">(</span>size<span class="token punctuation">)</span> order of fries<span class="token operator">!</span>”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token keyword">let</span> brand<span class="token punctuation">,</span> <span class="token keyword">let</span> ounces<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“a \<span class="token punctuation">(</span>ounces<span class="token punctuation">)</span>oz \<span class="token punctuation">(</span>brand<span class="token punctuation">)</span>”<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span>cookie<span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>“a cookie<span class="token operator">!</span>”<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above code would print “a 32oz Coke” on the console</p> <p>Note that the local variable that retrieves the associated data can have a different name</p> <ul><li>(e.g. <code>pattyCount</code> above versus <code>patties</code> in the <code>enum</code> declaration)</li> <li>(e.g. <code>brand</code> above versus not even having a name in the enum declaration)</li></ul> <p><strong>Methods yes, (stored) Properties no</strong></p> <p>An enum can have methods (and computed properties) but no stored properties ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token function">hamburger</span><span class="token punctuation">(</span>numberOfPatties<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token function">fries</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token builtin">FryOrderSize</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token function">drink</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> ounces<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> cookie
	
	<span class="token keyword">func</span> <span class="token function">isIncludedInSpecialOrder</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
	<span class="token keyword">var</span> calories<span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span> <span class="token comment">// calculate and return caloric value here }</span>
<span class="token punctuation">}</span>
</code></pre></div><p>An enum’s state is entirely which case it is in and that case’s associated data.</p> <p>In an enum’s own methods, you can test the enum’s state (and get associated data) using self ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">func</span> <span class="token function">isIncludedInSpecialOrder</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span>
		<span class="token keyword">switch</span> <span class="token keyword">self</span> <span class="token punctuation">{</span>
			<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">hamburger</span><span class="token punctuation">(</span><span class="token keyword">let</span> pattyCount<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> pattyCount <span class="token operator">==</span> number
			<span class="token keyword">case</span> <span class="token punctuation">.</span>fries<span class="token punctuation">,</span> <span class="token punctuation">.</span>cookie<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token boolean">true</span> <span class="token comment">// a drink and cookie in every special order</span>
			<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token number">_</span><span class="token punctuation">,</span> <span class="token keyword">let</span> ounces<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> ounces <span class="token operator">==</span> <span class="token number">16</span> <span class="token comment">// &amp; 16oz drink of any kind</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Special order 1 is a single patty burger, 2 is a double patty (3 is a triple, etc.?!)</p> <p>Notice the use of <code>_</code> if we don’t care about that piece of associated data.</p> <p><strong>Modifying <code>self</code> in an enum</strong></p> <p>You can even reassign self inside an enum method ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">FastFoodMenuItem</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">switchToBeingACookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">self</span> <span class="token operator">=</span> <span class="token punctuation">.</span>cookie <span class="token comment">// this works even if self is a .hamburger, .fries or .drink</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note that mutating is required because enum is a VALUE TYPE.</p> <h4 id="optionals-are-enums"><a href="#optionals-are-enums" aria-hidden="true" class="header-anchor">#</a> Optionals are <code>enums</code></h4> <p>It essentially looks like this ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">Optional</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// a generic type, like Array&lt;Element&gt; or Dictionary&lt;Key,Value&gt;</span>
	<span class="token keyword">case</span> <span class="token keyword">none</span>
	<span class="token keyword">case</span> <span class="token function">some</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token comment">// the some case has associated data of type T</span>
<span class="token punctuation">}</span>
</code></pre></div><p>But this type is so important that it has a lot of special syntax that other types don’t have ...</p> <p><strong>Special Optional syntax in Swift</strong></p> <p>The “not set” case has a special keyword: <code>nil</code></p> <ul><li><p>The character <code>?</code> is used to declare an Optional</p> <p>e.g. <code>var indexOfOneAndOnlyFaceUpCard: Int?</code></p></li> <li><p>The character <code>!</code> is used to “unwrap” the associated data if an Optional is in the “set” state ...</p> <p>e.g. <code>let index = cardButtons.index(of: button)!</code></p></li> <li><p>The keyword <code>if</code> can also be used to conditionally get the associated data ...</p> <p>e.g. <code>if let index = cardButtons.index(of: button) { ... }</code></p></li> <li><p>An Optional declared with <code>!</code> (instead of ?) will implicitly unwrap (add !) when accessed ...</p> <p>e.g. <code>var flipCountIndex: UILabel!</code> enables <code>flipCountIndex.text = “...”</code> (i.e. no ! here)</p></li> <li><p>You can use <code>??</code> to create an expression which “defaults” to a value if an Optional is not set ...</p> <p>e.g. <code>return emoji[card.identifier] ?? “?”</code></p></li> <li><p>You can also use <code>?</code> when accessing an Optional to bail out of an expression midstream ...</p> <p>this is called Optional Chaining, we’ll take a closer look at it in a few slides</p></li></ul> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">enum</span> <span class="token builtin">Optional</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token keyword">none</span>
	<span class="token keyword">case</span> <span class="token function">some</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Declaring and assigning values to an Optional ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span>
<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> “hello”
<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token constant">nil</span>

<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">Optional</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">none</span>
<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">Optional</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>“hello”<span class="token punctuation">)</span>
<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">Optional</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">none</span>
</code></pre></div><p>Note that Optionals always start out <code>nil</code> ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> hello<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function">print</span><span class="token punctuation">(</span>hello<span class="token operator">!</span><span class="token punctuation">)</span>

<span class="token keyword">switch</span> hello <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">:</span> <span class="token comment">// raise an exception (crash)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">let</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">if</span> <span class="token keyword">let</span> greeting <span class="token operator">=</span> hello <span class="token punctuation">{</span>
	<span class="token function">print</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
	<span class="token comment">// do something else</span>
<span class="token punctuation">}</span>

<span class="token keyword">switch</span> hello <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">let</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// do something else }</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Implicitly unwrapped Optional (these start out <code>nil</code> too)...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">!</span>
hello <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function">print</span><span class="token punctuation">(</span>hello<span class="token punctuation">)</span>

<span class="token keyword">var</span> hello<span class="token punctuation">:</span> <span class="token builtin">Optional</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">none</span>
<span class="token keyword">switch</span> hello <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">:</span> <span class="token comment">// raise exception (crash)</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">let</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Nil-coalescing operator (Optional defaulting) ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> x<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> x <span class="token operator">?</span><span class="token operator">?</span> “foo”

<span class="token keyword">switch</span> x <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">:</span> y <span class="token operator">=</span> “foo”
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">let</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span> y <span class="token operator">=</span> data
<span class="token punctuation">}</span>
</code></pre></div><p>Optional chaining ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> x<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>bar<span class="token operator">?</span><span class="token punctuation">.</span>z

<span class="token keyword">switch</span> x <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">:</span> y <span class="token operator">=</span> <span class="token constant">nil</span>
	<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">let</span> data1<span class="token punctuation">)</span><span class="token punctuation">:</span>
 		<span class="token keyword">switch</span> data1<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">:</span> y <span class="token operator">=</span> <span class="token constant">nil</span>
			<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">let</span> data2<span class="token punctuation">)</span><span class="token punctuation">:</span>
				<span class="token keyword">switch</span> data2<span class="token punctuation">.</span>bar <span class="token punctuation">{</span>
					<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">:</span> y <span class="token operator">=</span> <span class="token constant">nil</span>
					<span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">let</span> data3<span class="token punctuation">)</span><span class="token punctuation">:</span> y <span class="token operator">=</span> data3<span class="token punctuation">.</span>z
				<span class="token punctuation">}</span> 
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="data-structure-review-including-memory-management"><a href="#data-structure-review-including-memory-management" aria-hidden="true" class="header-anchor">#</a> Data structure review (including memory management)</h4> <p><strong>Four Essential Data Structure-building Concepts in Swift</strong></p> <ul><li><p>class</p> <ul><li>Supports object-oriented design</li> <li>Single inheritance of both functionality and data (i.e. instance variables)</li> <li>Reference type (classes are stored in the heap and are passed around via pointers)</li> <li>Heap is automatically “kept clean” by Swift (via reference counting, not garbage collection) Examples: ViewController, UIButton, Concentration</li></ul></li> <li><p>struct</p> <ul><li>Value type (structs don’t live in the heap and are passed around by copying them) Very efficient “copy on write” is automatic in Swift</li> <li>This copy on write behavior requires you to mark mutating methods</li> <li>No inheritance (of data)</li> <li>Mutability controlled via let (e.g. you can’t add elements to an Array assigned by let) Supports functional programming design</li> <li>Examples: Card, Array, Dictionary, String, Character, Int, Double, UInt32</li></ul> <p>Let’s jump over to Concentration and see what happens if we make Concentration a struct ...</p> <p><strong>Make Concentration into a struct</strong></p> <p>We’ll see that there’s little difference in how it’s declared</p></li> <li><p>enum</p> <ul><li>Used for variables that have one of a discrete set of values</li> <li>Each option for that discrete value can have “associated data” with it</li> <li>The associated data is the only storage that an enum can have (no instance variables) Value type (i.e. passed around by copying)</li> <li>Can have methods and computed (only) properties</li> <li>Example: we’ll create a PlayingCard struct that uses Rank and Suit enums</li></ul></li> <li><p>protocol</p> <ul><li>A type which is a declaration of functionality only</li> <li>No data storage of any kind (so it doesn’t make sense to say it’s a “value” or “reference” type)</li> <li>Essentially provides multiple inheritance (of functionality only, not storage) in Swift</li> <li>We’ll “ease into” learning about protocols since it’s new to most of you</li> <li>Let’s dive a little deeper into protocols ...</li></ul></li></ul> <h4 id="memory-management"><a href="#memory-management" aria-hidden="true" class="header-anchor">#</a> Memory Management</h4> <p><strong>Automatic Reference Counting</strong></p> <p>Reference types (classes) are stored in the heap.
How does the system know when to reclaim the memory for these from the heap?</p> <p>It “counts references” to each of them and when there are zero references, they get tossed.</p> <p>This is done automatically.</p> <p>It is known as “Automatic Reference Counting” and it is NOT garbage collection.</p> <p><strong>Influencing ARC</strong></p> <p>You can influence ARC by how you declare a reference-type var with these keywords ...</p> <ul><li><code>strong</code> <ul><li>strong is “normal” reference counting</li> <li>As long as anyone, anywhere has a strong pointer to an instance, it will stay in the heap</li> <li>Default so never use (Also not keywords)</li></ul></li> <li><code>weak</code> <ul><li>outlets <code>@IBOutlet</code> (UI related) / delegation (MVC)</li> <li>weak means “if no one else is interested in this, then neither am I, set me to nil in that case”</li> <li>Because it has to be nil-able, weak only applies to Optional pointers to reference types</li> <li>A weak pointer will NEVER keep an object in the heap</li> <li>Great example: outlets (strongly held by the view hierarchy, so outlets can be weak)</li></ul></li> <li><code>unowned</code> <ul><li>unowned means “don’t reference count this; crash if I’m wrong”</li> <li>This is very rarely used</li> <li>Usually only to break memory cycles between objects (more on that in a little while)</li></ul></li></ul> <h4 id="protocols-time-permitting"><a href="#protocols-time-permitting" aria-hidden="true" class="header-anchor">#</a> protocols (time permitting)</h4> <h3 id="✅-complete-the-second-reading"><a href="#✅-complete-the-second-reading" aria-hidden="true" class="header-anchor">#</a> ✅ Complete the second reading.</h3> <p><a href="https://github.com/chuxubank/Learning-iOS/blob/master/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/Reading-2-Intro-to-Swift.pdf" target="_blank" rel="noopener noreferrer">Reading 2: Intro to Swift<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="more-swift"><a href="#more-swift" aria-hidden="true" class="header-anchor">#</a> More Swift</h2> <p>Paul Hegarty continues his coverage of Swift.</p> <p>Topics Include: Data Structures, Struct, Protocol, Enum, Delegation, Extension, String, Character, NSAttributedString, Function Types, Closures</p> <p>Note: English subtitles are available within the video: enable English CC subtitles.</p> <h3 id="✅-watch-the-fourth-lecture-video"><a href="#✅-watch-the-fourth-lecture-video" aria-hidden="true" class="header-anchor">#</a> ✅ Watch the fourth lecture video.</h3> <p><a href="https://youtu.be/FU2V0YRQIOw?list=PLPA-ayBrweUzGFmkT_W65z64MoGnKRZMq" target="_blank" rel="noopener noreferrer">Lecture 4: More Swift<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <video width="100%" controls="controls" preload=""><source src="https://applehosted.podcasts.apple.com/stanford/media/4_More_Swift_336-3848977901446740876-04_10_04_17_CS193p_1080p_3mb_cc.m4v"></video> <h3 id="✅-review-lecture-4-slides"><a href="#✅-review-lecture-4-slides" aria-hidden="true" class="header-anchor">#</a> ✅ Review Lecture 4 Slides.</h3> <p><a href="https://github.com/chuxubank/Learning-iOS/blob/master/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/Lecture-4-Slides.pdf" target="_blank" rel="noopener noreferrer">Lecture 4 Slides<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="quick-demo-of-mutating"><a href="#quick-demo-of-mutating" aria-hidden="true" class="header-anchor">#</a> Quick demo of mutating</h4> <p>It's only funcs that we have to put that on.</p> <p><code>struct</code> is a <code>value type</code> that copy on writes stuff, that's why we care that it's mutating.</p> <p><code>class</code> is <code>reference type</code> that class just lives once in the heap, and you're passing pointers to it around.</p> <h4 id="protocols"><a href="#protocols" aria-hidden="true" class="header-anchor">#</a> protocols</h4> <p><strong>Protocols are a way to express an API more concisely</strong></p> <p>Instead of forcing the caller of an API to pass a specific class, struct, or enum,
an API can let callers pass any class/struct/enum that the caller wants
but can require that they implement certain methods and/or properties that the API wants.</p> <p>The API expresses the functions or variables it wants the caller to provide using a protocol. So a protocol is simply a collection of method and property declarations.</p> <p><strong>What are <code>protocol</code>s good for?</strong></p> <ul><li>Making API more flexible and expressive</li> <li>Blind, structured communication between View and Controller (delegation)</li> <li>Mandating behavior (e.g. the keys of a Dictionary must be hashable)</li> <li>Sharing functionality in disparate types (String, Array, CountableRange are all Collections) Multiple inheritance (of functionality, not data)</li></ul> <p><strong>A protocol is a TYPE</strong></p> <p>It can be used almost anywhere any other type is used: vars, function parameters, etc.</p> <p><strong>There are three aspects to a protocol</strong></p> <ol><li>the protocol declaration (which properties and methods are in the protocol)</li> <li>a class, struct or enum declaration that makes the claim to implement the protocol</li> <li>the code in said class, struct or enum (or extension) that implements the protocol</li></ol> <p><strong>Optional methods in a protocol</strong>
Normally any protocol implementor must implement all the methods/properties in the protocol.</p> <p>However, it is possible to mark some methods in a protocol <code>optional</code> (don’t get confused with the type Optional, this is a different thing).</p> <p>Any protocol that has optional methods must be marked <code>@objc</code>.</p> <p>And any class that implements an optional protocol must inherit from <code>NSObject</code>.</p> <p>These sorts of <code>protocol</code>s are used often in iOS for <code>delegation</code> (more later on this).</p> <p>Except for delegation, a <code>protocol</code> with <code>optional</code> methods is rarely (if ever) used.</p> <p>As you can tell from the <code>@objc</code> designation, it’s mostly for backwards compatibility.</p> <p><strong>Declaration of the protocol itself</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">SomeProtocol</span> <span class="token punctuation">:</span> <span class="token builtin">InheritedProtocol1</span><span class="token punctuation">,</span> <span class="token builtin">InheritedProtocol2</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> someProperty<span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token keyword">set</span> <span class="token punctuation">}</span>
	<span class="token keyword">func</span> <span class="token function">aMethod</span><span class="token punctuation">(</span>arg1<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> anotherArgument<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">SomeType</span>
	<span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">changeIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">init</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token keyword">Type</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Anyone that implements SomeProtocol must also implement InheritedProtocol1 and 2</p> <p>You must specify whether a property is get only or both <code>get</code> and <code>set</code></p> <p>Any functions that are expected to mutate the receiver should be marked <code>mutating</code> (unless you are going to restrict your protocol to class implementers only with <code>class</code> keyword) (rarely)</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">SomeProtocol</span> <span class="token punctuation">:</span> <span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token builtin">InheritedProtocol1</span><span class="token punctuation">,</span> <span class="token builtin">InheritedProtocol2</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><p>You can even specify that implementers must implement a given <code>init</code>ializer</p> <p><strong>How an implementer says “I implement that protocol”</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">class</span> <span class="token class-name">SomeClass</span> <span class="token punctuation">:</span> <span class="token builtin">SuperclassOfSomeClass</span><span class="token punctuation">,</span> <span class="token builtin">SomeProtocol</span><span class="token punctuation">,</span> <span class="token builtin">AnotherProtocol</span> <span class="token punctuation">{</span>
	<span class="token comment">// implementation of SomeClass here</span>
	<span class="token comment">// which must include all the properties and methods in SomeProtocol &amp; AnotherProtocol</span>
	<span class="token keyword">required</span> <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Claims of conformance to protocols are listed after the superclass for a class (obviously, <code>enum</code>s and <code>struct</code>s would not have the superclass part)</p> <p>Any number of protocols can be implemented by a given class, struct or enum</p> <p>In a class, <code>init</code>s must be marked <code>required</code> (or otherwise a subclass might not conform)</p> <p>You are allowed to add <code>protocol</code> conformance via an <code>extension</code></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token builtin">Something</span> <span class="token punctuation">:</span> <span class="token builtin">SomeProtocol</span> <span class="token punctuation">{</span>
	<span class="token comment">// implementation of SomeProtocol here</span>
	<span class="token comment">// no stored properties though</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Using protocols like the type that they are!</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">Moveable</span> <span class="token punctuation">{</span>
	<span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">move</span><span class="token punctuation">(</span>to point<span class="token punctuation">:</span> <span class="token builtin">CGPoint</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">:</span> <span class="token builtin">Moveable</span> <span class="token punctuation">{</span>
	<span class="token keyword">func</span> <span class="token function">move</span><span class="token punctuation">(</span>to point<span class="token punctuation">:</span> <span class="token builtin">CGPoint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
	<span class="token keyword">func</span> <span class="token function">changeOil</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token builtin">Shape</span> <span class="token punctuation">:</span> <span class="token builtin">Moveable</span> <span class="token punctuation">{</span>
	<span class="token keyword">mutating</span> <span class="token keyword">func</span> <span class="token function">move</span><span class="token punctuation">(</span>to point<span class="token punctuation">:</span> <span class="token builtin">CGPoint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
	<span class="token keyword">func</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> prius<span class="token punctuation">:</span> <span class="token builtin">Car</span> <span class="token operator">=</span> <span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> square<span class="token punctuation">:</span> <span class="token builtin">Shape</span> <span class="token operator">=</span> <span class="token function">Shape</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> thingToMove<span class="token punctuation">:</span> <span class="token builtin">Moveable</span> <span class="token operator">=</span> prius
thingToMove<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
thingToMove<span class="token punctuation">.</span><span class="token function">changeOil</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// error: thingToMove is only Moveable.</span>
thingToMove <span class="token operator">=</span> square
<span class="token keyword">let</span> thingsToMove<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">Moveable</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>prius<span class="token punctuation">,</span> square<span class="token punctuation">]</span>

<span class="token keyword">func</span> <span class="token function">slide</span><span class="token punctuation">(</span>slider<span class="token punctuation">:</span> <span class="token builtin">Moveable</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> positionToSlideTo <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	slider<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> positionToSlideTo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">slide</span><span class="token punctuation">(</span>prius<span class="token punctuation">)</span>
<span class="token function">slide</span><span class="token punctuation">(</span>square<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">slipAndSlide</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">Slippery</span> <span class="token operator">&amp;</span> <span class="token builtin">Moveable</span><span class="token punctuation">)</span>
<span class="token function">slipAndSlide</span><span class="token punctuation">(</span>prius<span class="token punctuation">)</span>	<span class="token comment">// error: prius is not Slippery</span>
</code></pre></div><h4 id="delegation"><a href="#delegation" aria-hidden="true" class="header-anchor">#</a> Delegation</h4> <ul><li><p>A very important (simple) use of <code>protocol</code>s</p> <p>It’s a way to implement “blind communication” between a View and its Controller</p></li> <li><p>How it plays out ...</p> <ol><li>A View declares a delegation protocol (i.e. what the View wants the Controller to do for it)</li> <li>The View’s API has a weak delegate property whose type is that delegation   protocol</li> <li>The View uses the delegate property to get/do things it can’t own or control on its own</li> <li>The Controller declares that it implements the protocol</li> <li>The Controller sets delegate of the View to itself using the property in #2   above</li> <li>The Controller implements the protocol (probably it has lots of optional methods in it)</li></ol></li> <li><p>Now the View is hooked up to the Controller</p> <p>But the View still has no idea what the Controller is, so the View remains generic/reusable</p></li> <li><p>This mechanism is found throughout iOS
However, it was designed pre-closures in Swift. Closures are sometimes a better option. We’ll learn about closures soon.</p></li></ul> <p><strong>Example</strong></p> <p>UIScrollView (which we’ll talk about next week) has a delegate property ...</p> <p><code>weak var delegate: UIScrollViewDelegate?</code></p> <p>The UIScrollViewDelegate protocol looks like this ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token atrule">@objc</span> <span class="token keyword">protocol</span> <span class="token builtin">UIScrollViewDelegate</span> <span class="token punctuation">{</span>
	<span class="token keyword">optional</span> <span class="token keyword">func</span> <span class="token function">scrollViewDidScroll</span><span class="token punctuation">(</span>scrollView<span class="token punctuation">:</span> <span class="token builtin">UIScrollView</span><span class="token punctuation">)</span>
	<span class="token keyword">optional</span> <span class="token keyword">func</span> <span class="token function">viewForZooming</span><span class="token punctuation">(</span><span class="token keyword">in</span> scrollView<span class="token punctuation">:</span> <span class="token builtin">UIScrollView</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">UIView</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> and many more <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A Controller with a UIScrollView in its View would be declared like this ...</p> <p><code>class MyViewController : UIViewController, UIScrollViewDelegate { ... }</code></p> <p>... probably in the <code>@IBOutlet didSet</code> for the scroll view, the Controller would do ...</p> <p><code>scrollView.delegate = self</code></p> <p>... and the Controller then would implement any of the protocol’s methods it is interested in.</p> <h4 id="another-use-of-protocols"><a href="#another-use-of-protocols" aria-hidden="true" class="header-anchor">#</a> Another use of Protocols</h4> <p><strong>Being a key in a Dictionary</strong></p> <p>To be a key in a Dictionary, you have to be able to be unique.
A key in a Dictionary does this by providing an Int that is very probably unique (a hash) and then also by implementing equality testing to see if two keys are, in fact, the same.</p> <p>This is enforced by requiring that a Dictionary’s keys implement the <code>Hashable</code> protocol. Here’s what that protocol looks like ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">Hashable</span><span class="token punctuation">:</span> <span class="token builtin">Equatable</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> hashValue<span class="token punctuation">:</span> <span class="token builtin">Int</span> <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Very simple. Note, though, that Hashable inherits from <code>Equatable</code> ...</p> <p>That means that to be <code>Hashable</code>, you also have to implement <code>Equatable</code>. The Equatable protocol looks like this ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">protocol</span> <span class="token builtin">Equatable</span> <span class="token punctuation">{</span>
	<span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token operator">==</span><span class="token punctuation">(</span>lhs<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">,</span> rhs<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Types that conform to Equatable have to have a type function (note the <code>static</code>) called == The arguments to == are both of that same type (i.e. Self of the type is the type itself)</p> <p>The == operator also happens to look for such a static method to provide its implementation!</p> <p>Dictionary is then declared like this: <code>Dictionary&lt;Key: Hashable, Value&gt;</code></p> <p>This restricts keys to be things that conform to Hashable (there’s no restriction on values)</p> <p>Let’s go make Card be Hashable.</p> <p>Then we can use it directly as the key into our emoji Dictionary.
As a bonus, we’ll be able to compare Cards directly since they’ll be Equatable.
This will even allow us to make identifier be private in Card, which makes a lot of sense.</p> <p><strong>Demo: Make Card struct Hashable and Equatable</strong></p> <p>Doing this allows us to make Card’s identifier private</p> <p>It also lets us look up Cards directly in a Dictionary (rather than with its identifier)</p> <p>And we can use == to compare Cards directly</p> <p>And for your homework, supporting Equatable lets you use index(of:) on an Array of things</p> <h4 id="advanced-use-of-protocols"><a href="#advanced-use-of-protocols" aria-hidden="true" class="header-anchor">#</a> Advanced use of Protocols</h4> <ul><li><p>“Multiple inheritance” with protocols</p> <ul><li><code>CountableRange</code> implements many protocols, but here are a couple of important ones ...</li> <li><code>Sequence</code> — makeIterator (and thus supports <code>for in</code>)</li> <li><code>Collection</code> — subscripting (i.e. []), index(offsetBy:), index(of:), etc.</li></ul></li> <li><p>Why do it this way?</p> <p>Because <code>Array</code>, for example, also implements these protocols.</p> <p>So now Apple can create generic code that operates on a Collection and it will work on both!</p> <p><code>Dictionary</code> is also a Collection, as is <code>Set</code> and <code>String</code>.</p> <p>And they don’t all just inherit the fact that they implement the methods in Collection, they actually inherit an implementation of many of the methods in Collection, because ...</p></li> <li><p>protocol &amp; extension</p> <p><strong>Using extension to provide protocol implementation</strong></p> <p>We said that protocol implementation is provided by implementing types (struct, enum, class)</p> <p>However, an <code>extension</code> can be used to add default implementation to a protocol.</p> <p>Since there’s no storage, said implementation has to be in terms of other API in the protocol (and any API in any protocol that that protocol inherits from, of course).</p> <p>For example, for the Sequence protocol, you really only need to implement makeIterator. (An iterator implements the IteratorProtocol which just has the method next().)</p> <p>If you do, you will automatically get implementations for all these other methods in Sequence: <code>contains()</code>, <code>forEach()</code>, <code>joined(separator:)</code>, <code>min()</code>, <code>max()</code>, even <code>filter()</code> and <code>map()</code>, et. al. All of these are implemented via an extension to the Sequence protocol.</p> <p>This extension (provided by Apple) uses only Sequence protocol methods in its implementation.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">extension</span> <span class="token builtin">Sequence</span> <span class="token punctuation">{</span>
    <span class="token keyword">func</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">_</span> element<span class="token punctuation">:</span> <span class="token builtin">Element</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token comment">// etc.</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Functional Programming</p> <p>By combining protocols with generics and extensions (default implementations),you can build code that focusses more on the behavior of data structures than storage.</p> <p>This approach to development is called “functional programming.”</p> <p>It is different than “object-oriented programming” (it’s sort of an evolution thereof).</p> <p>We don’t have time to teach functional programming, but you are getting a taste of it.</p> <p>What’s great about Swift is that it supports both paradigms.</p></li></ul> <h4 id="string"><a href="#string" aria-hidden="true" class="header-anchor">#</a> String</h4> <p><strong>The characters in a String</strong></p> <p>A String is made up of Unicodes, but there’s also the concept of a <code>Character</code>.</p> <p>A <code>Character</code> is what a human would perceive to be a single lexical character.</p> <p>This is true even if a single <code>Character</code> is made up of multiple Unicodes.</p> <p>For example, there is a Unicode which is “apply an accent to the previous character”.</p> <p>But there is also a Unicode which is é (the letter e with an accent on it).</p> <p>So the string café might be 4 Unicodes (c-a-f-é) or 5 Unicodes (c-a-f-e-’).</p> <p>In either case, we preceive it as 4 <code>Character</code>s.</p> <p>Because of this ambiguity, the index into a String cannot be an Int.</p> <p>Is the p in “café pesto” at index 5 or index 6? Depends on the é.</p> <p>Indices into Strings are therefore of a different type ... <code>String.Index</code>.</p> <p>The simplest ways to get an index are <code>startIndex</code>, <code>endIndex</code> and <code>index(of:)</code>.</p> <p>There are other ways (see the documentation for more).</p> <p>To move to another index, use <code>index(String.Index, offsetBy: Int)</code>.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> pizzaJoint <span class="token operator">=</span> “café pesto”
<span class="token keyword">let</span> firstCharacterIndex <span class="token operator">=</span> pizzaJoint<span class="token punctuation">.</span>startIndex <span class="token comment">// of type String.Index</span>
<span class="token keyword">let</span> fourthCharacterIndex <span class="token operator">=</span> pizzaJoint<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>firstCharacterIndex<span class="token punctuation">,</span> offsetBy<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> fourthCharacter <span class="token operator">=</span> pizzaJoint<span class="token punctuation">[</span>fourthCharacterIndex<span class="token punctuation">]</span> <span class="token comment">// é</span>

<span class="token keyword">if</span> <span class="token keyword">let</span> firstSpace <span class="token operator">=</span> pizzaJoint<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> “ “<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// returns nil if “ ” not found</span>
	<span class="token keyword">let</span> secondWordIndex <span class="token operator">=</span> pizzaJoint<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>firstSpace<span class="token punctuation">,</span> offsetBy<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token keyword">let</span> secondWord <span class="token operator">=</span> pizzaJoint<span class="token punctuation">[</span>secondWordIndex<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span>pizzaJoint<span class="token punctuation">.</span>endIndex<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note the <code>..&lt;</code> above.</p> <p>This is a <code>Range</code> of <code>String.Index</code>.</p> <p>Range is a generic type (like Array is). It doesn’t have to be a range of Ints.</p> <p>Another way to find the second word: <code>pizzaJoint.components(separatedBy: “ “)[1]</code></p> <p>components(separatedBy:) returns an <code>Array&lt;String&gt;</code> (might be empty, though, so careful!)</p> <p>String is also a Collection (in the same sense that an Array is a Collection) of Characters</p> <p>All the indexing stuff (index(of:), etc.) is part of Collection.</p> <p>A Collection is also a Sequence, so you can do things like ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">for</span> c <span class="token keyword">in</span> s <span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment">// iterate through all Characters in s </span>
<span class="token keyword">let</span> characterArray <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// Array&lt;Character&gt;</span>
</code></pre></div><p>(Array has an init that takes any Sequence as an argument.)</p> <p><strong>A String is a value type (it’s a struct)</strong></p> <p>We usually work with immutable Strings (i.e. <code>let s = ...</code>).</p> <p>But there are mutating methods on String as well, for example ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> s <span class="token operator">=</span> pizzaJoint <span class="token comment">// makes a mutable copy of pizzaJoint (because it’s a value type!) </span>
s<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>contentsOf<span class="token punctuation">:</span> “ foo”<span class="token punctuation">,</span> at<span class="token punctuation">:</span> s<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> “ “<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token comment">// café foo pesto</span>
</code></pre></div><p>The type of contentsOf: argument is any Collection of Character (which String is).</p> <p><strong>Other String Methods</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function">hasPrefix</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span>
<span class="token keyword">func</span> <span class="token function">hasSuffix</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Bool</span>
<span class="token keyword">var</span> localizedCapitalized<span class="token operator">/</span><span class="token builtin">Lowercase</span><span class="token operator">/</span><span class="token builtin">Uppercase</span><span class="token punctuation">:</span> <span class="token builtin">String</span>
<span class="token keyword">func</span> <span class="token function">replaceSubrange</span><span class="token punctuation">(</span><span class="token builtin">Range</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token punctuation">.</span><span class="token builtin">Index</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token builtin">Collection</span> of <span class="token builtin">Character</span><span class="token punctuation">)</span> 
</code></pre></div><p>e.g., <code>s.replaceSubrange(..&lt;s.endIndex, with: “new contents”)</code></p> <p>Note the <code>..&lt;</code> Range appears to have no start! It defaults to the start of the String.</p> <p>And much, much more. Check out the documentation.</p> <p><strong>Demo: Change our <code>emojiChoices</code> to be a String</strong></p> <p>It really doesn’t matter either way</p> <p>But it’s a good opportunity to compare String and Array (which are surprisingly similar)</p> <p>We’ll also get a little bit of insight into the protocol-based design of the Foundation framework</p> <h4 id="nsattributedstring"><a href="#nsattributedstring" aria-hidden="true" class="header-anchor">#</a> NSAttributedString</h4> <p><strong>A String with attributes attached to each character</strong></p> <p>Conceptually, an object that pairs a String and a Dictionary of attributes for each Character.</p> <p>The Dictionary’s keys are things like “the font” or “the color”, etc.</p> <p>The Dictionary’s values depend on what the key is (UIFont or UIColor or whatever).</p> <p>Many times (almost always), large ranges of Characters have the same Dictionary.</p> <p>Often (like in your homework), the entire NSAttributedString uses the same Dictionary.</p> <p>You can put NSAttributedStrings on UILabels, UIButtons, etc.</p> <p>Next week we’ll also learn how to draw an NSAttributedString on the screen directly.</p> <p><strong>Creating and using an NSAttributedString</strong></p> <p>Here’s how we’d make the flip count label have orange, outlined text ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> attributes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">NSAttributedStringKey</span> <span class="token punctuation">:</span> <span class="token builtin">Any</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token comment">// note: type cannot be inferred here</span>
	<span class="token punctuation">.</span>strokeColor <span class="token punctuation">:</span> <span class="token builtin">UIColor</span><span class="token punctuation">.</span>orange<span class="token punctuation">,</span>
	<span class="token punctuation">.</span>strokeWidth <span class="token punctuation">:</span> <span class="token number">5.0</span> <span class="token comment">// negative number here would mean fill (positive means outline)</span>
<span class="token punctuation">]</span>
<span class="token keyword">let</span> attribtext <span class="token operator">=</span> <span class="token function">NSAttributedString</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> “<span class="token builtin">Flips</span><span class="token punctuation">:</span> <span class="token number">0</span>”<span class="token punctuation">,</span> attributes<span class="token punctuation">:</span> attributes<span class="token punctuation">)</span> 
flipCountLabel<span class="token punctuation">.</span>attributedText <span class="token operator">=</span> attribtext <span class="token comment">// UIButton has attributedTitle</span>
</code></pre></div><p><strong>Peculiarities of NSAttributedString</strong></p> <p>NSAttributedString is a completely different data structure than String.</p> <p>The “NS” is a clue that it is an “old style” Objective-C class.</p> <p>Thus it is not really like String (for example, it’s a class, not a struct).</p> <p>Since it’s not a value type, you can’t create a mutable NSAttributedString by just using var.</p> <p>To get mutability, you have to use a subclass of it called <code>NSMutableAttributedString</code>.</p> <p>NSAttributedString was constructed with <code>NSString</code> in mind, not Swift’s String.</p> <p>NSString and String use slightly different encodings.</p> <p>There is some automatic bridging between old Objective-C stuff and Swift types.</p> <p>But it can be tricky with NSString to String bridging because of varying-length Unicodes.</p> <p>This all doesn’t matter if the entire string has the same attributes (like in your homework).</p> <p>Or if the NSAttributedString doesn’t contain “wacky” Unicode characters.</p> <p>Otherwise, be careful indexing into the NSAttributedString.</p> <p><strong>Demo: Make flip count outlined text</strong></p> <p>Let’s apply the code from the previous slide to Concentration</p> <div class="tip custom-block"><p><code>= 0</code> did not call <code>didSet</code>, but we can fix it by using <code>didSet</code> in outlet.</p></div> <h4 id="closures-and-functions-as-types-in-general"><a href="#closures-and-functions-as-types-in-general" aria-hidden="true" class="header-anchor">#</a> Closures (and functions as types in general)</h4> <p><strong>Function types</strong></p> <p>Functions are people<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> too!</p> <p>You can declare a variable (or parameter to a method or whatever) to be of type “function”</p> <p>You’ll declare it with the types of the functions arguments (and return type) included</p> <p>You can do this anywhere any other type is allowed</p> <p>Example ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> operation<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Double</span>
<span class="token comment">// This is a var called operation</span>
<span class="token comment">// It is of type “function that takes a Double and returns a Double”</span>
<span class="token comment">// You can assign it like any other variable ...</span>
operation <span class="token operator">=</span> sqrt <span class="token comment">// sqrt is just a function that takes a Double and returns a Double</span>
<span class="token comment">// You can “call” this function using syntax very similar to any function call ...</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">)</span> <span class="token comment">// result will be 2.0</span>
</code></pre></div><p><strong>Closures</strong></p> <p>Often you want to create the function “on the fly” (rather than already-existing like sqrt).</p> <p>You can do this “in line” using a closure.</p> <p>Imagine we had a function that changed the sign of its argument ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function">changeSign</span><span class="token punctuation">(</span>operand<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Double</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">-</span>operand <span class="token punctuation">}</span>
</code></pre></div><p>We could use it instead of sqrt ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> operation<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Double</span>
operation <span class="token operator">=</span> changeSign
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">)</span> <span class="token comment">// result will be -4.0</span>
</code></pre></div><p>We can “in line” changeSign simply by moving the function (without its name) below ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
operation <span class="token operator">=</span> <span class="token punctuation">(</span>operand<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Double</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">-</span>operand <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">// A minor syntactic change: Move the first `{` to the start and replace with `in` ...</span>
operation <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>operand<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Double</span> <span class="token keyword">in</span> <span class="token keyword">return</span> <span class="token operator">-</span>operand <span class="token punctuation">}</span>
<span class="token comment">// Swift can infer that operation returns a Double</span>
operation <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>operand<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token keyword">return</span> <span class="token operator">-</span>operand <span class="token punctuation">}</span>
<span class="token comment">// Swift can infer that operation returns a Double and that operand is a Double</span>
operation <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>operand<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token keyword">return</span> <span class="token operator">-</span>operand <span class="token punctuation">}</span>
<span class="token comment">// It also knows that operation returns a value, so the return keyword is unnecessary</span>
operation <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>operand<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token keyword">return</span> <span class="token operator">-</span>operand <span class="token punctuation">}</span>
<span class="token comment">// It also knows that operation returns a value, so the return keyword is unnecessary</span>
operation <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>operand<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">-</span>operand <span class="token punctuation">}</span>
<span class="token comment">// And finally, it’ll let you replace the parameter names with $0, $1, $2, etc., and skip in ...</span>
operation <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">-</span>$<span class="token number">0</span> <span class="token punctuation">}</span>
</code></pre></div><p><strong>Where do we use closures?</strong></p> <p>Often as arguments to methods.</p> <p>Many times a method wants to know “what to do” and providing a function tells it what to do.</p> <p>For example, what to do when there’s an error or when something asynchronous finishes.</p> <p>Or maybe you want to ask some method to repeatedly perform a function ...</p> <p>Array has a method called <code>map</code> which takes a function as an argument.</p> <p>It applies that function to each element of the Array to create and return a new Array.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">let</span> primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">7.0</span><span class="token punctuation">,</span> <span class="token number">11.0</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> negativePrimes <span class="token operator">=</span> primes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">-</span>$<span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// [-2.0, -3.0, -5.0, -7.0, -11.0]</span>
<span class="token keyword">let</span> invertedPrimes <span class="token operator">=</span> primes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">1.0</span><span class="token operator">/</span>$<span class="token number">0</span> <span class="token punctuation">}</span> <span class="token comment">// [0.5, 0.333, 0.2, etc.]</span>
<span class="token keyword">let</span> primeStrings <span class="token operator">=</span> primes<span class="token punctuation">.</span><span class="token builtin">map</span> <span class="token punctuation">{</span> <span class="token function">String</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token comment">// [“2.0”,”3.0”,”5.0”,”7.0”,”11.0”]</span>
</code></pre></div><p><code>trailing closure</code> syntax</p> <p>Note that if the last (or only) argument to a method is a closure, you can put it outside the method’s parentheses that contain its arguments and if the closure was the only argument, you can skip the () completely if you want.</p> <p><strong>Closures with property initialization</strong></p> <p>You can also execute a closure to do initialization of a property if you want ...</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> someProperty<span class="token punctuation">:</span> <span class="token keyword">Type</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token comment">// construct the value of someProperty here </span>
	<span class="token keyword">return</span> <span class="token operator">&lt;</span>the constructed value<span class="token operator">&gt;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>This is especially useful with <code>lazy</code> property initialization.</p> <p><strong>Capturing</strong></p> <p>Closures are regular types, so they can be put in Arrays, Dictionarys, etc.</p> <p>When this happens, they are stored in the heap (i.e. they are reference types).</p> <p>What is more, they “capture” variables they use from the surrounding code into the heap too.</p> <p>Those captured variables need to stay in the heap as long as the closure stays in the heap.</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">var</span> ltuae <span class="token operator">=</span> <span class="token number">42</span>
operation <span class="token operator">=</span> <span class="token punctuation">{</span> ltuae <span class="token operator">*</span> $<span class="token number">0</span> <span class="token punctuation">}</span> <span class="token comment">// “captures” the ltuae var because it’s needed for this closure </span>
arrayOfOperations<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>operation<span class="token punctuation">)</span>
<span class="token comment">// if we later change ltuae, then the next time we evaluate operation it will reflect that</span>
<span class="token comment">// even if we leave the scope (function or whatever) that this code is in!</span>
</code></pre></div><p>This can create a memory cycle though.</p> <p>We’ll see this later in the quarter and how to avoid that.</p> <p><strong>Demo: Improve indexOfOneAndOnlyFaceUpCard implementation</strong></p> <p>We probably used more lines of code to make indexOfOneAndOnlyFaceUpCard computed However, a better implementation using a method that takes a closure would fix that</p> <h3 id="✅-complete-programming-project-2"><a href="#✅-complete-programming-project-2" aria-hidden="true" class="header-anchor">#</a> ✅ Complete Programming Project 2.</h3> <p><a href="https://github.com/chuxubank/Learning-iOS/blob/master/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/Programming-Project-2-Set.pdf" target="_blank" rel="noopener noreferrer">Programming Project 2: Set<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <hr class="footnotes-sep"> <section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>i.e. methods and properties <a href="#fnref1" class="footnote-backref">↩︎</a></p></li> <li id="fn2" class="footnote-item"><p>er, types <a href="#fnref2" class="footnote-backref">↩︎</a></p></li></ol></section></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/chuxubank/Learning-iOS/edit/master/Developing-iOS-11-Apps-with-Swift/L3-Swift-Overview/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/28/2019, 9:03:10 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L2-MVC-iOS-Xcode-Swift-Demonstration/" class="prev">
          MVC; iOS, Xcode and Swift Demonstration
        </a></span> <span class="next"><a href="/Learning-iOS/Developing-iOS-11-Apps-with-Swift/L4-Drawing-in-iOS/">
          Drawing in iOS
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Learning-iOS/assets/js/app.57d53fc2.js" defer></script><script src="/Learning-iOS/assets/js/2.92025711.js" defer></script><script src="/Learning-iOS/assets/js/8.63388885.js" defer></script>
  </body>
</html>
